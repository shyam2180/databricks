on:
  push:
    branches:
      - main
 
jobs:
  build:
    runs-on: ubuntu-latest
 
    steps:
    - name: Checkout repository
      uses: actions/checkout@v2
 
    - name: Set up Databricks CLI
      run: |
        pip install databricks-cli
        export DATABRICKS_TOKEN=${{ secrets.DATABRICKS_TOKEN }}
        databricks configure --token
 
    - name: Upload Notebook to Databricks
      run: |
        # Replace '/Workspace/Folder/Path' with the actual path in your Databricks workspace
        # Replace 'local/path/to/your/notebook' with the actual path to your notebook file
        databricks workspace import -l /Workspace/cicd -o "C:\Users\ShyamKumarR\OneDrive - JMAN Group Ltd\Desktop\test_cicd_output\ci_cd.py"
 
    - name: Run Databricks Notebook
      run: |
        databricks workspace create --name 'MyJob' --folder '/Workspace/Folder/Path' --format SOURCE --language SOURCE --overwrite
        databricks jobs run-now --job-id <job-id> # Use the actual job ID
